<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Re: [ruby-ffi] How to manage an Array of Structs</title>
<link rel="important stylesheet" href="">
<style>div.headerdisplayname {font-weight:bold;}</style></head>
<body>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><div class="headerdisplayname" style="display:inline;">Subject: </div>Re: [ruby-ffi] How to manage an Array of Structs</td></tr><tr><td><div class="headerdisplayname" style="display:inline;">From: </div>Wayne Meissner <wmeissner@gmail.com></td></tr><tr><td><div class="headerdisplayname" style="display:inline;">Date: </div>4/28/11 8:59 AM</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><div class="headerdisplayname" style="display:inline;">To: </div>ruby-ffi@googlegroups.com</td></tr></table><br>
<div class="moz-text-html"  lang="x-unicode"><br><div>Charles' answer is correct, except you don't need to copy the bytes in/out, you can just cast the pointer to the Struct type:</div><div><meta charset="utf-8"><span class="Apple-style-span" style="border-collapse: collapse; "><br># access first element of&nbsp;<span class="il" style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(207, 223, 229); color: rgb(82, 81, 81); background-position: initial initial; background-repeat: initial initial; ">array</span><br>s0 =&nbsp;</span><span class="Apple-style-span" style="border-collapse: collapse; color: rgb(34, 34, 34); ">Shared:<wbr>:</span><span class="Apple-style-span" style="border-collapse: collapse; ">Sembuf.new(ops[0])</span></div><div><span class="Apple-style-span" style="border-collapse: collapse; ">s0[:sem_op] = 0x4321</span><br></div><div><span class="Apple-style-span" style="border-collapse: collapse; "><br># access second element of&nbsp;<span class="il" style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(207, 223, 229); color: rgb(82, 81, 81); background-position: initial initial; background-repeat: initial initial; ">array</span><br>s1 =&nbsp;</span><span class="Apple-style-span" style="border-collapse: collapse; color: rgb(34, 34, 34); ">Shared:<wbr>:</span><span class="Apple-style-span" style="border-collapse: collapse; ">Sembuf.new(ops[1])</span></div><meta charset="utf-8"><div><span class="Apple-style-span" style="border-collapse: collapse; ">s1[:sem_op] = 0x1234</span><br></div><div><span class="Apple-style-span" style="border-collapse: collapse; "><br></span></div><div><span class="Apple-style-span" style="border-collapse: collapse; ">... etc</span></div><div><span class="Apple-style-span" style="border-collapse: collapse; "><br></span></div><div><span class="Apple-style-span" style="border-collapse: collapse; ">That way, reads/writes to Struct fields will directly update the pointer you allocated.</span></div><div><span class="Apple-style-span" style="border-collapse: collapse; "><br></span></div><div><span class="Apple-style-span" style="border-collapse: collapse; "><br></span></div>
</div></body>
</html>
</table></div>