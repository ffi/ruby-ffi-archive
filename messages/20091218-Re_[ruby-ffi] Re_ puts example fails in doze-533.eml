Delivered-To: headius@headius.com
Received: by 10.100.134.8 with SMTP id h8cs393873and;
        Fri, 18 Dec 2009 13:41:17 -0800 (PST)
Received: by 10.142.195.4 with SMTP id s4mr2587711wff.309.1261172477164;
        Fri, 18 Dec 2009 13:41:17 -0800 (PST)
Return-Path: <3-vYrSwkJCGgcSKOYYTKXMSGOR.IUSXaHe-LLOMUUMRKMXUaVY.IUS@listserv.bounces.google.com>
Received: from mail-pw0-f68.google.com (mail-pw0-f68.google.com [209.85.160.68])
        by mx.google.com with ESMTP id 7si10552973pwi.24.2009.12.18.13.41.15;
        Fri, 18 Dec 2009 13:41:16 -0800 (PST)
Received-SPF: pass (google.com: domain of 3-vYrSwkJCGgcSKOYYTKXMSGOR.IUSXaHe-LLOMUUMRKMXUaVY.IUS@listserv.bounces.google.com designates 209.85.160.68 as permitted sender) client-ip=209.85.160.68;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of 3-vYrSwkJCGgcSKOYYTKXMSGOR.IUSXaHe-LLOMUUMRKMXUaVY.IUS@listserv.bounces.google.com designates 209.85.160.68 as permitted sender) smtp.mail=3-vYrSwkJCGgcSKOYYTKXMSGOR.IUSXaHe-LLOMUUMRKMXUaVY.IUS@listserv.bounces.google.com; dkim=pass (test mode) header.i=@googlegroups.com
Received: by pwj20 with SMTP id 20sf1534889pwj.27
        for <headius@headius.com>; Fri, 18 Dec 2009 13:41:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=beta;
        h=domainkey-signature:received:x-beenthere:received:received:received
         :received:received-spf:received:mime-version:received:in-reply-to
         :references:date:message-id:subject:from:to
         :x-original-authentication-results:x-original-sender:reply-to
         :precedence:mailing-list:list-id:list-post:list-help:list-archive
         :x-thread-url:x-message-url:sender:list-unsubscribe:list-subscribe
         :content-type;
        bh=Pm2knePYWl0GdYaUeBpPvINaids71+In4wBN4uitNzY=;
        b=woPhkNsixKN4fxUT3PUrfNZSCmU8fFGj7qdqX8hjPGkjpGsr/fb1NrmhnQybSn1SKc
         IkiLgrgQY/4pO1KPJ7XewL29H5oo4/8d/1Kcs1yp69Se21NcA5QF1oIbnB1fGTw53tbj
         9+VzRZa37X/dy56aK9uZgOYp89FHMb1l/tjB8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlegroups.com; s=beta;
        h=x-beenthere:received-spf:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:x-original-authentication-results
         :x-original-sender:reply-to:precedence:mailing-list:list-id
         :list-post:list-help:list-archive:x-thread-url:x-message-url:sender
         :list-unsubscribe:list-subscribe:content-type;
        b=mn5zJN9e02BMbLY+tiF70bj1Q0oRdCqY7KpzNerYrVr37XS+BW9FvJtCBzPy4SOLiz
         KlSyNhc1YjoSiwikmJ/lUfiXpgtgJQyuD6uzZk1uYX0y43WVWhX4CN2NHtfXRtW2ux5q
         Be7ZeIGQKrgrY35xSCagbM8lnxs/Lg6Et749s=
Received: by 10.115.101.29 with SMTP id d29mr508561wam.17.1261172474671;
        Fri, 18 Dec 2009 13:41:14 -0800 (PST)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.114.188.15 with SMTP id l15ls659waf.3.p; Fri, 18 Dec 2009 
	13:41:14 -0800 (PST)
Received: by 10.115.148.3 with SMTP id a3mr949121wao.20.1261172473908;
        Fri, 18 Dec 2009 13:41:13 -0800 (PST)
Received: by 10.115.148.3 with SMTP id a3mr949120wao.20.1261172473888;
        Fri, 18 Dec 2009 13:41:13 -0800 (PST)
Return-Path: <wmeissner@gmail.com>
Received: from mail-pw0-f55.google.com (mail-pw0-f55.google.com [209.85.160.55])
        by gmr-mx.google.com with ESMTP id 19si741735pzk.8.2009.12.18.13.41.12;
        Fri, 18 Dec 2009 13:41:12 -0800 (PST)
Received-SPF: pass (google.com: domain of wmeissner@gmail.com designates 209.85.160.55 as permitted sender) client-ip=209.85.160.55;
Received: by pwj2 with SMTP id 2so2589101pwj.34
        for <ruby-ffi@googlegroups.com>; Fri, 18 Dec 2009 13:41:12 -0800 (PST)
MIME-Version: 1.0
Received: by 10.141.214.22 with SMTP id r22mr3028572rvq.165.1261172472175; 
	Fri, 18 Dec 2009 13:41:12 -0800 (PST)
In-Reply-To: <71166b3b0912181031g240449a3x705d8f24024e7bdc@mail.gmail.com>
References: <14840f0a-7d65-4897-b67f-5c3b488df81c@s20g2000yqd.googlegroups.com>
	 <05bec24b-58dc-42c6-b9aa-0e33e1a0ca58@s31g2000yqs.googlegroups.com>
	 <74375019-722d-46a4-819c-22bb3670f49d@b2g2000yqi.googlegroups.com>
	 <71166b3b0912181031g240449a3x705d8f24024e7bdc@mail.gmail.com>
Date: Sat, 19 Dec 2009 07:41:11 +1000
Message-ID: <4ccee320912181341h794c3b3ue74f96234cb4ed79@mail.gmail.com>
Subject: Re: [ruby-ffi] Re: puts example fails in doze
From: Wayne Meissner <wmeissner@gmail.com>
To: ruby-ffi@googlegroups.com
X-Original-Authentication-Results: gmr-mx.google.com; spf=pass (google.com: 
	domain of wmeissner@gmail.com designates 209.85.160.55 as permitted sender) 
	smtp.mail=wmeissner@gmail.com; dkim=pass (test mode) header.i=@gmail.com
X-Original-Sender: wmeissner@gmail.com
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=>
X-Thread-Url: http://groups.google.com/group/ruby-ffi/t/dc9ffa7683d8d613
X-Message-Url: http://groups.google.com/group/ruby-ffi/msg/b7323425198def67
Sender: ruby-ffi@googlegroups.com
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
Content-Type: text/plain; charset=ISO-8859-1

2009/12/19 Luis Lavena <luislavena@gmail.com>:
>> works in linux without doing an explicit ffi_lib call...I'm curious as
>> to why windows require ffi_lib 'msvcrt', when it is linked against
>> msvcrt in the beginning to start with (I guess)?
>> Any ideas there?
>
> Mentioned in another thread about default library being used
> automatically. I guess the gem didn't had the support baked in?

That has changed in ruby-ffi 0.6.0 & JRuby 1.5.0; you now need to
explicitly specify the library, or specify
FFI::Library::CURRENT_PROCESS as the library.

Tips (as of 0.6.0):

1) FFI::Library::LIBC will always be the correct
libc.so/libc.dylib/msvcrt.dll for the current platform.

2) Avoid using FFI::Library::CURRENT_PROCESS, unless you're hacking
ruby VM internals using FFI.  The set of libraries that are loaded
into the VM differ from VM to VM and from OS to OS, so relying on the
current process having e.g. calloc(3) in its symbol table will lead to
your program/library breaking.
