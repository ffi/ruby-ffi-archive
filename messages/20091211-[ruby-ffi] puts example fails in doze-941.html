<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>[ruby-ffi] puts example fails in doze</title>
<link rel="important stylesheet" href="">
<style>div.headerdisplayname {font-weight:bold;}</style></head>
<body>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><div class="headerdisplayname" style="display:inline;">Subject: </div>[ruby-ffi] puts example fails in doze</td></tr><tr><td><div class="headerdisplayname" style="display:inline;">From: </div>rogerdpack <rogerpack2005@gmail.com></td></tr><tr><td><div class="headerdisplayname" style="display:inline;">Date: </div>12/11/09 4:58 PM</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><div class="headerdisplayname" style="display:inline;">To: </div>ruby-ffi <ruby-ffi@googlegroups.com></td></tr></table><br>
<div class="moz-text-plain" wrap=true graphical-quote=true style="font-family: -moz-fixed; font-size: 12px;" lang="x-western"><pre wrap>
in windows, this code fails:

require 'ffi'

module Hello
  extend FFI::Library
  attach_function 'puts', [:string], :int
end

Hello.puts("Hello, World")


thusly:
C:\dev\ruby\ruby-benchmark-suite\benchmarks\micro-benchmarks&gt;ruby -v
test.rb
ruby 1.9.1p243 (2009-07-16 revision 24175) [i386-mingw32]
C:<i class="moz-txt-slash"><span class="moz-txt-tag">/</span>installs/ruby-1.9.1-p243-tweaked/lib/ruby/gems/1.9.1/gems<span class="moz-txt-tag">/</span></i>
sane-0.11.0/lib/sane/hash_set_operators_bug_fix.rb:4: warning: method
redefined; discarding old -

        #&lt;FFI::NotFoundError: Function 'puts' not found in [[current
process]]&gt; Function 'puts' not found in [[current process]]
C:/installs/ruby-1.9.1-p243-tweaked/lib/ruby/gems/1.9.1/gems/ffi-0.5.4-
x86-mingw32/lib/ffi/library.rb:77:in `attach_function'
        raise FFI::NotFoundError.new(cname.to_s, ffi_libraries.map { |
lib| lib.name }) unless invoker
test.rb:5:in `&lt;module:Hello&gt;'
        attach_function 'puts', [:string], :int
test.rb:3:in `&lt;main&gt;'
        module Hello

&lt;main&gt;: Function 'puts' not found in [[current process]]
(FFI::NotFoundError)


Is this expected? Is there an example function that should work cross
platform?
-r
</pre></div></body>
</html>
</table></div>