Delivered-To: headius@headius.com
Received: by 10.151.8.3 with SMTP id l3cs213586ybi;
        Mon, 5 Apr 2010 01:10:22 -0700 (PDT)
Received: by 10.151.59.20 with SMTP id m20mr6057942ybk.82.1270455022478;
        Mon, 05 Apr 2010 01:10:22 -0700 (PDT)
Return-Path: <365q5SwkJCIsB1tx772t6v1px0.r3169qD-uuxv33v0tv63947.r31@groups.bounces.google.com>
Received: from mail-gy0-f190.google.com (mail-gy0-f190.google.com [209.85.160.190])
        by mx.google.com with ESMTP id 17si11610692yxe.122.2010.04.05.01.10.21;
        Mon, 05 Apr 2010 01:10:21 -0700 (PDT)
Received-SPF: pass (google.com: domain of 365q5SwkJCIsB1tx772t6v1px0.r3169qD-uuxv33v0tv63947.r31@groups.bounces.google.com designates 209.85.160.190 as permitted sender) client-ip=209.85.160.190;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of 365q5SwkJCIsB1tx772t6v1px0.r3169qD-uuxv33v0tv63947.r31@groups.bounces.google.com designates 209.85.160.190 as permitted sender) smtp.mail=365q5SwkJCIsB1tx772t6v1px0.r3169qD-uuxv33v0tv63947.r31@groups.bounces.google.com; dkim=pass (test mode) header.i=@googlegroups.com
Received: by gyg8 with SMTP id 8sf3038700gyg.7
        for <headius@headius.com>; Mon, 05 Apr 2010 01:10:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=beta;
        h=domainkey-signature:received:x-beenthere:received:received:received
         :received:received-spf:received:mime-version:received:in-reply-to
         :references:date:received:message-id:subject:from:to
         :x-original-authentication-results:x-original-sender:reply-to
         :precedence:mailing-list:list-id:list-post:list-help:list-archive
         :x-thread-url:x-message-url:sender:list-subscribe:list-unsubscribe
         :content-type;
        bh=06RKVXfTmDUH4/XkARGrSNkL8b/3NrP+J5ooYqd/dXs=;
        b=aGLlTbpA8tXV3saMTHTfIhK/GmJSr87xVSOQW64xiGlnMrwZjl934Kkfk8KWAV8Fos
         AYLDJ7peMwZCXAbW4lQI8QqPvlUYcqludUHxp4B615JzW/z3/+x6kU7exUtgPY/NU5Ck
         Zbq++WmnyeFJszJ4eypEwKfa0VBFCtS/t8nhk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlegroups.com; s=beta;
        h=x-beenthere:received-spf:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:x-original-authentication-results
         :x-original-sender:reply-to:precedence:mailing-list:list-id
         :list-post:list-help:list-archive:x-thread-url:x-message-url:sender
         :list-subscribe:list-unsubscribe:content-type;
        b=tvJa3oidu/8y5lx2Sgk68gI2zS+343SbnlJdiijFmtSgIL9G5hk+761rluPoIKzMIU
         ORoiz9gHEPneT1RRD69ZxC+KqxOHG8QyFSOMgtD8MgGYuvquRx2SHsC/lTqMvkq01c4J
         zSLJWqEKyOH3HezP+Ybpo9xUX0VB6Fo1cmYKY=
Received: by 10.91.160.33 with SMTP id m33mr191343ago.54.1270455019769;
        Mon, 05 Apr 2010 01:10:19 -0700 (PDT)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.231.51.234 with SMTP id e42ls9820ibg.2.p; Mon, 05 Apr 2010 
	01:10:08 -0700 (PDT)
Received: by 10.231.162.18 with SMTP id t18mr338662ibx.3.1270455008321;
        Mon, 05 Apr 2010 01:10:08 -0700 (PDT)
Received: by 10.231.162.18 with SMTP id t18mr338661ibx.3.1270455008299;
        Mon, 05 Apr 2010 01:10:08 -0700 (PDT)
Return-Path: <wmeissner@gmail.com>
Received: from mail-pz0-f188.google.com (mail-pz0-f188.google.com [209.85.222.188])
        by gmr-mx.google.com with ESMTP id 24si1754655iwn.1.2010.04.05.01.10.07;
        Mon, 05 Apr 2010 01:10:07 -0700 (PDT)
Received-SPF: pass (google.com: domain of wmeissner@gmail.com designates 209.85.222.188 as permitted sender) client-ip=209.85.222.188;
Received: by pzk26 with SMTP id 26so295706pzk.6
        for <ruby-ffi@googlegroups.com>; Mon, 05 Apr 2010 01:10:06 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.140.191.6 with HTTP; Mon, 5 Apr 2010 01:10:06 -0700 (PDT)
In-Reply-To: <f1480d60-84ff-47d3-961c-dd681dfb7ea9@g10g2000yqh.googlegroups.com>
References: <f1480d60-84ff-47d3-961c-dd681dfb7ea9@g10g2000yqh.googlegroups.com>
Date: Mon, 5 Apr 2010 18:10:06 +1000
Received: by 10.141.15.21 with SMTP id s21mr3430550rvi.192.1270455006809; Mon, 
	05 Apr 2010 01:10:06 -0700 (PDT)
Message-ID: <s2z4ccee321004050110mad26e3bg81a18a3a1f66b418@mail.gmail.com>
Subject: Re: [ruby-ffi] FFI from C?
From: Wayne Meissner <wmeissner@gmail.com>
To: ruby-ffi@googlegroups.com
X-Original-Authentication-Results: gmr-mx.google.com; spf=pass (google.com: 
	domain of wmeissner@gmail.com designates 209.85.222.188 as permitted sender) 
	smtp.mail=wmeissner@gmail.com; dkim=pass (test mode) header.i=@gmail.com
X-Original-Sender: wmeissner@gmail.com
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=en_US>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=en_US>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=en_US>
X-Thread-Url: http://groups.google.com/group/ruby-ffi/t/60105d58f411128f
X-Message-Url: http://groups.google.com/group/ruby-ffi/msg/f79c7734adc661db
Sender: ruby-ffi@googlegroups.com
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
Content-Type: text/plain; charset=ISO-8859-1

Short answer is 'no' - there is no C api for Ruby-FFI.

However, can you drive the integration from the ruby side, ala the lua
bindings (http://github.com/jmettraux/rufus-lua)?

I had a quick search for calling Haskell from C, and it looks like it
might be doable - if its callable from straight C, then you can call
it via FFI.

Basically how it would go is:

1) create ruby wrapper method
2) massage ruby data into basic C types (int, string, struct, raw
chunk of memory, etc)
3) call C method exported by Haskell with massaged parameters
4) convert Haskell result back into ruby type.

Calling back into ruby from Haskell via a C function pointer works
similarly, but in reverse.

There was an example on stackoverflow using DL to do this - FFI would
work much the same.

If you're doing it the other way round, calling ruby from Haskell,
you're doomed.  There is no common C api, and no C api at all on JRuby
or IronRuby.


On 5 April 2010 09:03, Mark  Wotton <mwotton@gmail.com> wrote:
> I know this is not the standard method of using the FFI, but is it
> possible to do everything from C? I'm the author of Hubris, a bridge
> between Haskell and Ruby, and because I have way more type information
> on the Haskell side, I'd much rather keep computation on that side,
> which means accessing the FFI from the C side. I'm currently using
> libruby, and it's pretty painful - there's a lot of work to support
> 1.8 and 1.9, and I haven't even considered what it'd take to support
> JRuby yet.
>
> so, to recap: I need a way to reach into the ruby interpreter and get
> type info, as well as access to basic data (numbers, strings, arrays
> and hashes is probably sufficient for now). Is ruby-FFI a good bet?
>
> cheers
> Mark
>
>
> --
> To unsubscribe, reply using "remove me" as the subject.
>
