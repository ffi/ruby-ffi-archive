Delivered-To: headius@headius.com
Received: by 10.100.110.10 with SMTP id i10cs945310anc;
        Thu, 28 Jan 2010 12:20:18 -0800 (PST)
Received: by 10.101.167.19 with SMTP id u19mr4505230ano.182.1264710018412;
        Thu, 28 Jan 2010 12:20:18 -0800 (PST)
Return-Path: <3f_FhSwgJCB4PMCTCEIPAG4CF.6IGLO5S-99CAIIAF8ALIOJM.6IG@groups.bounces.google.com>
Received: from mail-yx0-f137.google.com (mail-yx0-f137.google.com [209.85.210.137])
        by mx.google.com with ESMTP id 40si2429306ywh.95.2010.01.28.12.20.17;
        Thu, 28 Jan 2010 12:20:17 -0800 (PST)
Received-SPF: pass (google.com: domain of 3f_FhSwgJCB4PMCTCEIPAG4CF.6IGLO5S-99CAIIAF8ALIOJM.6IG@groups.bounces.google.com designates 209.85.210.137 as permitted sender) client-ip=209.85.210.137;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of 3f_FhSwgJCB4PMCTCEIPAG4CF.6IGLO5S-99CAIIAF8ALIOJM.6IG@groups.bounces.google.com designates 209.85.210.137 as permitted sender) smtp.mail=3f_FhSwgJCB4PMCTCEIPAG4CF.6IGLO5S-99CAIIAF8ALIOJM.6IG@groups.bounces.google.com; dkim=pass (test mode) header.i=@googlegroups.com
Received: by yxe1 with SMTP id 1sf3263205yxe.3
        for <headius@headius.com>; Thu, 28 Jan 2010 12:20:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=beta;
        h=domainkey-signature:received:x-beenthere:received:received:received
         :received:received-spf:received:mime-version:received:in-reply-to
         :references:date:message-id:subject:from:to
         :x-original-authentication-results:x-original-sender:reply-to
         :precedence:mailing-list:list-id:list-post:list-help:list-archive
         :x-thread-url:x-message-url:sender:list-subscribe:list-unsubscribe
         :content-type:content-transfer-encoding;
        bh=kc6U1uOZR2twfHmRg4WBdA1wtSFDxR6qKYruAMfa7PE=;
        b=BsuuMnHDzYTvVrsRJoKmvXlbNtCYdOI/ihcLr+7cN44nZsFuiYHVIala2oT9HJL/9L
         MzxpCk9W2YnKzSzPpcYl6+eeFY0b224b/+uKlfnHvE0Rh2NGSZBUPFHmAK3/08gz5x2X
         lAT3LP3rhzecDbgpnMUWuZa7UdtTEWFx5oHh8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlegroups.com; s=beta;
        h=x-beenthere:received-spf:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:x-original-authentication-results
         :x-original-sender:reply-to:precedence:mailing-list:list-id
         :list-post:list-help:list-archive:x-thread-url:x-message-url:sender
         :list-subscribe:list-unsubscribe:content-type
         :content-transfer-encoding;
        b=mFRAkusq3LeECmtM/0g4uZY86EgwGvVe/IuJiMkP3NG2qh2uJlzMZUlvuap7N5x6sh
         QaiRz6jM+pxJ7jVAc0o4MS8Ht7kb25cXMK/xMMrkzghRISiXpW/2bzxioT9FEwOCy8mj
         ke56uaGEFk7JFvUoQAVulKWorOJSV/U9HcPMs=
Received: by 10.101.152.34 with SMTP id e34mr779699ano.29.1264710015759;
        Thu, 28 Jan 2010 12:20:15 -0800 (PST)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.204.26.205 with SMTP id f13ls355321bkc.0.p; Thu, 28 Jan 2010 
	12:20:14 -0800 (PST)
Received: by 10.204.14.82 with SMTP id f18mr366319bka.25.1264710013999;
        Thu, 28 Jan 2010 12:20:13 -0800 (PST)
Received: by 10.204.14.82 with SMTP id f18mr366318bka.25.1264710013961;
        Thu, 28 Jan 2010 12:20:13 -0800 (PST)
Return-Path: <vsizikov@gmail.com>
Received: from fg-out-1718.google.com (fg-out-1718.google.com [72.14.220.153])
        by gmr-mx.google.com with ESMTP id 11si124285bwz.3.2010.01.28.12.20.12;
        Thu, 28 Jan 2010 12:20:12 -0800 (PST)
Received-SPF: pass (google.com: domain of vsizikov@gmail.com designates 72.14.220.153 as permitted sender) client-ip=72.14.220.153;
Received: by fg-out-1718.google.com with SMTP id 16so40601fgg.13
        for <ruby-ffi@googlegroups.com>; Thu, 28 Jan 2010 12:20:12 -0800 (PST)
MIME-Version: 1.0
Received: by 10.216.186.6 with SMTP id v6mr3674575wem.130.1264710012409; Thu, 
	28 Jan 2010 12:20:12 -0800 (PST)
In-Reply-To: <20100128145855.1f23ec7e.jon.forums@gmail.com>
References: <9ef47d23-21f0-4657-ac94-3cf8d7725016@a32g2000yqm.googlegroups.com>
	 <4ccee321001241612k70d81dbdgbf8b097b550c040f@mail.gmail.com>
	 <571aaacb-83dc-46af-a837-ea698dc31657@b2g2000yqi.googlegroups.com>
	 <20100128145855.1f23ec7e.jon.forums@gmail.com>
Date: Thu, 28 Jan 2010 21:20:12 +0100
Message-ID: <3454c9681001281220v3d9c2cb1kc43a2c4553dd6755@mail.gmail.com>
Subject: Re: [ruby-ffi] Re: Using Windows Unicode functions
From: Vladimir Sizikov <vsizikov@gmail.com>
To: ruby-ffi@googlegroups.com
X-Original-Authentication-Results: gmr-mx.google.com; spf=pass (google.com: 
	domain of vsizikov@gmail.com designates 72.14.220.153 as permitted sender) 
	smtp.mail=vsizikov@gmail.com; dkim=pass (test mode) header.i=@gmail.com
X-Original-Sender: vsizikov@gmail.com
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=en_US>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=en_US>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=en_US>
X-Thread-Url: http://groups.google.com/group/ruby-ffi/t/ada0ea99600b7fa1
X-Message-Url: http://groups.google.com/group/ruby-ffi/msg/7735f8d4960e0cda
Sender: ruby-ffi@googlegroups.com
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi folks,

While we're at this subject of Windows examples...

Here's one more:

http://gist.github.com/279004

Pretty handy module for me, it allows to lock the computer and to turn
the monitor off. :)

Thanks,
  --Vladimir

On Thu, Jan 28, 2010 at 8:58 PM, Jon <jon.forums@gmail.com> wrote:
> Nice!
>
> I minor tweaked the code and have added it to the wiki http://wiki.github=
.com/ffi/ffi/windows-examples#intermediate =A0Review and revise as needed.
>
> I removed the file encoding comment so as not to imply it's required, and=
 I tweaked the function signature and invocation to be a bit closer to the =
MessageBox API documentation.
>
> Probably makes sense to try 'jcode' with MRI 1.8 and see if it can be mad=
e to work. =A0The code doesn't work with JRuby 1.4.0 using --1.9 due to und=
efined "String#encode" and I haven't yet tried JRuby 1.5.
>
> From the FFI API perspective, can the Ruby string code be de-uglied with =
a combination of some clever #ifdef compile-time and runtime check magic?
>
> A new type binary blob type similar to :buffer_in but skips over the null=
-byte checking and encodes to UTF-16LE behind the scenes? =A0Something like=
 :unicode_string or :win_wide_string? =A0Could the new type also be made ap=
plicable to both Windows UTF-16 and *nix UTF-8/locale environments?
>
> Haven't thought about windows SBCS, DBCS, and MBCS C runtime code page is=
sues, but having an explicit type to help with Unicode WinAPI's could be he=
lpful and less error prone.
>
> ??
>
> Jon
>
