<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Re: [ruby-ffi] Re: Newbie ? about porting code from VB to Ruby</title>
<link rel="important stylesheet" href="">
<style>div.headerdisplayname {font-weight:bold;}</style></head>
<body>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><div class="headerdisplayname" style="display:inline;">Subject: </div>Re: [ruby-ffi] Re: Newbie ? about porting code from VB to Ruby</td></tr><tr><td><div class="headerdisplayname" style="display:inline;">From: </div>Charles Strahan <charles.c.strahan@gmail.com></td></tr><tr><td><div class="headerdisplayname" style="display:inline;">Date: </div>6/8/11 6:34 PM</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><div class="headerdisplayname" style="display:inline;">To: </div>ruby-ffi@googlegroups.com</td></tr></table><br>
<div class="moz-text-html"  lang="x-western">Woops, I screwed up the <span class="Apple-style-span" style="color: rgb(153, 0, 115); font-family: &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace; font-size: 12px; line-height: 16px; white-space: pre; ">wVersion</span> - should have been a uint16, instead of uint8.  The gist should be fixed now.<div>
<br></div><div>-Charles<br><br></div><div><br><div class="gmail_quote">On Wed, Jun 8, 2011 at 6:14 PM, Charles Strahan <span dir="ltr">&lt;<a href="mailto:charles.c.strahan@gmail.com">charles.c.strahan@gmail.com</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex;">Hi Jesse,<div><br></div><div>Welcome to the Ruby community!</div><div><br></div><div>I think this will work for you: <a href="https://gist.github.com/1015672" target="_blank">https://gist.github.com/1015672</a></div>
<div><br></div><div>I tried to annotate the sample as well as I could. If anything is unclear, or doesn&#39;t work, please let me know.</div>
<div><br></div><div>Unfortunately, I do not have the HLLAPI lib to test with, so I had to base that code off of the docs and some .NET samples.</div><div><br></div><div>HTH,</div><div><br></div><font color="#888888"><div>
-Charles</div></font><div><div></div><div class="h5"><div><a href="https://gist.github.com/1015672" target="_blank"></a><br>
<br><div class="gmail_quote">On Wed, Jun 8, 2011 at 1:11 PM, JesseFair <span dir="ltr">&lt;<a href="mailto:jfair9@gmail.com" target="_blank">jfair9@gmail.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">

I tried Win32API as well but cant find out how to pass the cutom data<br>
type WHLLAPIDATA that the WinHLLAPIStartup function is expecting.<br>
Being new to Ruby I cant find a way to construct something that acts<br>
similar to the above code -.. i.e. custom data types. I was able to<br>
get the examples up and working but they only use simple data types<br>
such as int and string.<br>
<div><br>
<br>
On Jun 8, 1:18 am, candlerb &lt;<a href="mailto:b.cand...@pobox.com" target="_blank">b.cand...@pobox.com</a>&gt; wrote:<br>
&gt; I am not a Windows expert, but have you tried looking at Win32API<br>
&gt; instead of FFI? This may be all that you need. There are plenty of<br>
&gt; examples if you google for them.<br>
&gt;<br>
</div>&gt; <a href="http://www.ruby-doc.org/docs/ProgrammingRuby/html/win32.htmlhttp://www.ruby-doc.org/docs/ProgrammingRuby/html/lib_windows.html" target="_blank">http://www.ruby-doc.org/docs/ProgrammingRuby/html/win32.htmlhttp://www.ruby-doc.org/docs/ProgrammingRuby/html/lib_windows.html</a></blockquote>

</div><br></div>
</div></div></blockquote></div><br></div>

</div></body>
</html>
</table></div>