Delivered-To: headius@headius.com
Received: by 10.216.86.75 with SMTP id v53cs49162wee;
        Sun, 13 Dec 2009 00:58:11 -0800 (PST)
Received: by 10.91.51.28 with SMTP id d28mr3309030agk.120.1260694690877;
        Sun, 13 Dec 2009 00:58:10 -0800 (PST)
Return-Path: <3oawkSwwJCL0id22l.dqguhdjpdlo.frpuxe1-iiljrrjohjurxsv.frp@listserv.bounces.google.com>
Received: from mail-gx0-f197.google.com (mail-gx0-f197.google.com [209.85.217.197])
        by mx.google.com with ESMTP id 11si6220963yxe.108.2009.12.13.00.58.10;
        Sun, 13 Dec 2009 00:58:10 -0800 (PST)
Received-SPF: pass (google.com: domain of 3oawkSwwJCL0id22l.dqguhdjpdlo.frpuxe1-iiljrrjohjurxsv.frp@listserv.bounces.google.com designates 209.85.217.197 as permitted sender) client-ip=209.85.217.197;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of 3oawkSwwJCL0id22l.dqguhdjpdlo.frpuxe1-iiljrrjohjurxsv.frp@listserv.bounces.google.com designates 209.85.217.197 as permitted sender) smtp.mail=3oawkSwwJCL0id22l.dqguhdjpdlo.frpuxe1-iiljrrjohjurxsv.frp@listserv.bounces.google.com
Received: by gxk21 with SMTP id 21sf1815607gxk.7
        for <headius@headius.com>; Sun, 13 Dec 2009 00:58:10 -0800 (PST)
Received: by 10.91.83.11 with SMTP id k11mr794234agl.2.1260694689562;
        Sun, 13 Dec 2009 00:58:09 -0800 (PST)
MIME-Version: 1.0
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.204.23.8 with SMTP id p8ls718110bkb.0.p; Sun, 13 Dec 2009 
	00:58:08 -0800 (PST)
Received: by 10.204.6.214 with SMTP id a22mr96643bka.1.1260694688037;
        Sun, 13 Dec 2009 00:58:08 -0800 (PST)
Received: by 10.204.6.214 with SMTP id a22mr96642bka.1.1260694688017;
        Sun, 13 Dec 2009 00:58:08 -0800 (PST)
Return-Path: <andrea.fazzi@alcacoop.it>
Received: from mail-fx0-f217.google.com (mail-fx0-f217.google.com [209.85.220.217])
        by gmr-mx.google.com with ESMTP id 18si193188bwz.5.2009.12.13.00.58.07;
        Sun, 13 Dec 2009 00:58:07 -0800 (PST)
Received-SPF: neutral (google.com: 209.85.220.217 is neither permitted nor denied by best guess record for domain of andrea.fazzi@alcacoop.it) client-ip=209.85.220.217;
Received: by fxm9 with SMTP id 9so2425763fxm.30
        for <ruby-ffi@googlegroups.com>; Sun, 13 Dec 2009 00:58:07 -0800 (PST)
Received: by 10.103.67.33 with SMTP id u33mr139964muk.8.1260694687549;
        Sun, 13 Dec 2009 00:58:07 -0800 (PST)
Return-Path: <andrea.fazzi@alcacoop.it>
Received: from ganimoide (host118-235-dynamic.41-79-r.retail.telecomitalia.it [79.41.235.118])
        by mx.google.com with ESMTPS id n10sm8763002mue.6.2009.12.13.00.58.07
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 13 Dec 2009 00:58:07 -0800 (PST)
Received: from andrea by ganimoide with local (Exim 4.69)
	(envelope-from <andrea@ganimoide>)
	id 1NJkHF-0004YO-Qo
	for ruby-ffi@googlegroups.com; Sun, 13 Dec 2009 09:58:05 +0100
Subject: Re: [ruby-ffi] ffi-swig generating a :string instead of a :pointer ??
From: Andrea Fazzi <andrea.fazzi@alcacoop.it>
To: ruby-ffi <ruby-ffi@googlegroups.com>
In-reply-to: <p06240816c74a1c8a7a94@[192.168.1.106]>
References: <p06240815c749eeffa690@[192.168.1.106]> <p06240816c74a1c8a7a94@[192.168.1.106]>
Date: Sun, 13 Dec 2009 09:58:05 +0100
Message-Id: <1260692022-sup-274@ganimoide>
User-Agent: Sup/git
X-Original-Authentication-Results: gmr-mx.google.com; spf=neutral (google.com: 
	209.85.220.217 is neither permitted nor denied by best guess record for 
	domain of andrea.fazzi@alcacoop.it) smtp.mail=andrea.fazzi@alcacoop.it
X-Original-Sender: fazzi.andrea@gmail.com
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=>
X-Thread-Url: http://groups.google.com/group/ruby-ffi/t/98eaf51ab0386347
X-Message-Url: http://groups.google.com/group/ruby-ffi/msg/81011ca7c7dd7b39
Sender: ruby-ffi@googlegroups.com
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Excerpts from Stephen Bannasch's message of dom dic 13 05:23:50 +0100 2009:
> >I have a C++ function that takes a pointer to a buffer where the function stores a C-string.
> >
> >This is what I wrote and got working.
> >
> >  attach_function :GoIO_GetNthAvailableDeviceName, [:pointer, :int, :int, :int, :int], :int
> >
> >However if I use ffi-swig it generates a :string as the first parameter.
> >
> >  attach_function :GoIO_GetNthAvailableDeviceName, [ :string, :int, :int, :int, :int ], :int
> >
> >Is there anyway this could work? The function needs an address to a location to store a C-string.
> 
> 
> Looking more closely at ffi-swig it's type_spec.rb does expect:
> 
>   char *string;
> 
> to be turned into a :string.
> 
> I'm not much of a C programmer but is that correct? It seems in this case it
> should be a pointer.

Using char* rather than const char* for string it's not strictly incorrect 
IMHO. I'd say it's a bad practice so, in this case, the generator is 
favoring a bad practice. I was troubled about the behaviour to impose in 
cases like this since so many libraries I processed with the generator 
follow the bad practice. And I ended up with the conversion char* ->
:string.

That said, you need a different behaviour now so I should reconsider my 
choice. BTW, I'd like to read the opinion of the ML about this.

Cheers,
-- 
Andrea Fazzi @ alcacoop.it
Follow me on http://twitter.com/remogatto
