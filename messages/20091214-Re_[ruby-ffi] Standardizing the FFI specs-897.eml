Delivered-To: headius@headius.com
Received: by 10.100.134.8 with SMTP id h8cs140523and;
        Mon, 14 Dec 2009 15:57:03 -0800 (PST)
Received: by 10.142.151.28 with SMTP id y28mr3589738wfd.143.1260835022980;
        Mon, 14 Dec 2009 15:57:02 -0800 (PST)
Return-Path: <3zdAmSwQPCBAuBq3vq11y3w834C.3u97ArE-vvyw44w1uw74A58.s42@listserv.bounces.google.com>
Received: from mail-pw0-f68.google.com (mail-pw0-f68.google.com [209.85.160.68])
        by mx.google.com with ESMTP id 15si11967548pzk.88.2009.12.14.15.57.02;
        Mon, 14 Dec 2009 15:57:02 -0800 (PST)
Received-SPF: pass (google.com: domain of 3zdAmSwQPCBAuBq3vq11y3w834C.3u97ArE-vvyw44w1uw74A58.s42@listserv.bounces.google.com designates 209.85.160.68 as permitted sender) client-ip=209.85.160.68;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of 3zdAmSwQPCBAuBq3vq11y3w834C.3u97ArE-vvyw44w1uw74A58.s42@listserv.bounces.google.com designates 209.85.160.68 as permitted sender) smtp.mail=3zdAmSwQPCBAuBq3vq11y3w834C.3u97ArE-vvyw44w1uw74A58.s42@listserv.bounces.google.com
Received: by pwj20 with SMTP id 20sf2134233pwj.27
        for <headius@headius.com>; Mon, 14 Dec 2009 15:57:02 -0800 (PST)
Received: by 10.140.83.37 with SMTP id g37mr695398rvb.28.1260835021674;
        Mon, 14 Dec 2009 15:57:01 -0800 (PST)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.141.188.31 with SMTP id q31ls1837565rvp.2.p; Mon, 14 Dec 2009 
	15:57:01 -0800 (PST)
Received: by 10.141.124.7 with SMTP id b7mr1110548rvn.5.1260835020819;
        Mon, 14 Dec 2009 15:57:00 -0800 (PST)
Received: by 10.114.44.6 with SMTP id r6mr1274854war.3.1260833344476;
        Mon, 14 Dec 2009 15:29:04 -0800 (PST)
Received: by 10.114.44.6 with SMTP id r6mr1274852war.3.1260833344456;
        Mon, 14 Dec 2009 15:29:04 -0800 (PST)
Return-Path: <evan@fallingsnow.net>
Received: from elle.fallingsnow.net (elle.fallingsnow.net [67.43.164.196])
        by gmr-mx.google.com with ESMTP id 24si1090477pzk.14.2009.12.14.15.29.03;
        Mon, 14 Dec 2009 15:29:03 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of evan@fallingsnow.net designates 67.43.164.196 as permitted sender) client-ip=67.43.164.196;
Received: from cpe-76-170-133-160.socal.res.rr.com ([76.170.133.160] helo=[10.0.1.194])
	by elle.fallingsnow.net with esmtpa (Exim 4.69)
	(envelope-from <evan@fallingsnow.net>)
	id 1NKKLZ-0003Yl-Nq
	for ruby-ffi@googlegroups.com; Mon, 14 Dec 2009 15:29:02 -0800
Mime-Version: 1.0 (Apple Message framework v1077)
From: Evan Phoenix <evan@fallingsnow.net>
In-Reply-To: <639B95D4-BE42-4AFC-87E9-DFFDC577ABAD@gmail.com>
Date: Mon, 14 Dec 2009 15:28:57 -0800
Message-Id: <E4CF4595-385A-4DF1-BDE6-145D8F3C5560@fallingsnow.net>
References: <20091210050131.GF18652@hinegardner.org> <4ccee320912092211y5436f813j6f40e2a33e7d9c62@mail.gmail.com> <20091210164632.GH18652@hinegardner.org> <639B95D4-BE42-4AFC-87E9-DFFDC577ABAD@gmail.com>
To: ruby-ffi@googlegroups.com
X-Mailer: Apple Mail (2.1077)
X-SA-Exim-Connect-IP: 76.170.133.160
X-SA-Exim-Mail-From: evan@fallingsnow.net
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on elle.fallingsnow.net
X-Spam-Level: 
X-Spam-Status: No, score=-4.2 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.5
Subject: Re: [ruby-ffi] Standardizing the FFI specs
X-SA-Exim-Version: 4.2.1 (built Wed, 25 Jun 2008 17:14:11 +0000)
X-SA-Exim-Scanned: Yes (on elle.fallingsnow.net)
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=>
X-Thread-Url: http://groups.google.com/group/ruby-ffi/t/e9a24d52f776ab04
X-Message-Url: http://groups.google.com/group/ruby-ffi/msg/8d50aa009da1bebc
Sender: ruby-ffi@googlegroups.com
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable

Hi Ernie,

I am indeed here.

There are 2 issues. The first is the API and it's divergence.

My original API was slim and light, but had a number of holes. Those =
holes have been filled by the different implementations in different =
ways and thusly only the simplest of APIs are now common.

I think that it is in the best interest of FFI, if it is truly to be a =
cross implementation API, that all new API additions stop and we begin =
to formalize a 1.0 API.

This would allow us a clean, consistent target for all implementations. =
In addition, it would simplify what to spec.

I don't want to turn this into design by committee, but if people do =
want the API to be cross implementation, some degree of coordination and =
agreement must be reached. Unilateral changes only destabilize the =
effort.

Since it appears that most of the FFI implementers are on this list, =
please reply to this email and indicate that you'd like to participate =
in the planning of the 1.0 API.=20

To kick off the 1.0 planning, here is the list of builtin types that I =
believe the 1.0 should contain:

Fundamental Types:

  Platform Independent: int8, uint8, int16, uint16, int32, uint32, =
int64, uint64, float32, float64, pointer, string, buffer

  Platform Dependent: char, uchar, int, uint, long, ulong, float, double

Composite Types:

  struct, callback


Users would have the ability to add their own aliases for structs, etc.

In addition, I believe the unix types provided by sys/types should be =
made available by requesting so. Perhaps calling "FFI.add_sys_types" =
would be fine (this as opposed to a require so that it can be calculated =
entirely at runtime if need be)

Thats a good place for us to start. Please comment.

 - Evan

On Dec 14, 2009, at 2:17 PM, Ernest Prabhakar wrote:

> Hi all,
>=20
> This is Dr. Ernie, one of the MacRuby committers. We would like to add =
the FFI specs <http://github.com/ffi/ffi/tree/master/spec/ffi/> to our =
existing RubySpec tests. =20
>=20
> When I asked on the rubyspec list about what could be done to =
"mainstream" FFI, I was told:
>=20
> On Dec 4, 2009, at 2:51 PM, Brian Ford wrote:
>> The specs need quite a bit of cleanup to conform to the rubyspec =
style guide.
>=20
> http://rubyspec.org/wiki/rubyspec/Style_Guide
>=20
>> Also, the API is still in flux a bit. If you'd like to
>> contribute to the specs or FFI API,  please coordinate with Evan
>> Phoenix (evan in #rubinius on freenode.net) as he is the original API
>> author and is trying to get the API standardized across
>> implementations.
>=20
> Evan, are you here? What process would you suggest?=20
>=20
> Should I file a bug about the specs (on Kenai)?  Or should I wait =
until the API stabilizes a bit more?
>=20
> -- Ernie P.
>=20
>=20
>=20
>=20

