Delivered-To: headius@headius.com
Received: by 10.182.92.135 with SMTP id cm7csp62222obb;
        Mon, 27 Feb 2012 08:15:07 -0800 (PST)
Received: by 10.152.127.136 with SMTP id ng8mr9998738lab.16.1330359306750;
        Mon, 27 Feb 2012 08:15:06 -0800 (PST)
Return-Path: <ruby-ffi+bncCP397LbnChCF2K76BBoEeGrjiw@googlegroups.com>
Received: from mail-lpp01m010-f62.google.com (mail-lpp01m010-f62.google.com [209.85.215.62])
        by mx.google.com with ESMTPS id g8si6125243lbz.66.2012.02.27.08.15.06
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 27 Feb 2012 08:15:06 -0800 (PST)
Received-SPF: pass (google.com: domain of ruby-ffi+bncCP397LbnChCF2K76BBoEeGrjiw@googlegroups.com designates 209.85.215.62 as permitted sender) client-ip=209.85.215.62;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of ruby-ffi+bncCP397LbnChCF2K76BBoEeGrjiw@googlegroups.com designates 209.85.215.62 as permitted sender) smtp.mail=ruby-ffi+bncCP397LbnChCF2K76BBoEeGrjiw@googlegroups.com; dkim=pass (test mode) header.i=@googlegroups.com
Received: by laai8 with SMTP id i8sf1828169laa.7
        for <headius@headius.com>; Mon, 27 Feb 2012 08:15:06 -0800 (PST)
Return-Path: <ruby-ffi+bncCP397LbnChCF2K76BBoEeGrjiw@googlegroups.com>
Received-SPF: pass (google.com: domain of ruby-ffi+bncCP397LbnChCF2K76BBoEeGrjiw@googlegroups.com designates 10.216.133.13 as permitted sender) client-ip=10.216.133.13;
Received: from mr.google.com ([10.216.133.13])
        by 10.216.133.13 with SMTP id p13mr2840771wei.40.1330359305971 (num_hops = 1);
        Mon, 27 Feb 2012 08:15:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=beta;
        h=x-beenthere:received-spf:message-id:date:from:user-agent
         :mime-version:to:subject:references:in-reply-to:x-virus-scanned
         :x-original-sender:x-original-authentication-results:reply-to
         :precedence:mailing-list:list-id:x-google-group-id:list-post
         :list-help:list-archive:sender:list-subscribe:list-unsubscribe
         :content-type:content-transfer-encoding;
        bh=mqs6BEZ+ikTD4CJaYxbM2ACDcPv+rMesA7airXegFf8=;
        b=hDXjvdHLoOQ2GujaDd3KfxoAA+tnjfggFlFGN1+Y0gD6NTtlL/AnTJZRtSJpfIbJb+
         TLERl04FmIza9NzUURUrt6nP89KKXMukgZrz0xzB+6//D/3WDbgpbIjv4MoEIcaid2Mt
         wVWVIbQJ+7HpwxaFXNH2A1sDeWofSTQ0B7JrM=
Received: by 10.216.133.13 with SMTP id p13mr835138wei.40.1330359301739;
        Mon, 27 Feb 2012 08:15:01 -0800 (PST)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.14.199.195 with SMTP id x43ls2736931een.5.gmail; Mon, 27 Feb
 2012 08:15:00 -0800 (PST)
Received: by 10.213.22.1 with SMTP id l1mr1844683ebb.1.1330359300256;
        Mon, 27 Feb 2012 08:15:00 -0800 (PST)
Received: by 10.213.22.1 with SMTP id l1mr1844681ebb.1.1330359300234;
        Mon, 27 Feb 2012 08:15:00 -0800 (PST)
Received: from smtp-vbr13.xs4all.nl (smtp-vbr13.xs4all.nl. [194.109.24.33])
        by gmr-mx.google.com with ESMTP id f9si11308942eea.2.2012.02.27.08.14.59;
        Mon, 27 Feb 2012 08:14:59 -0800 (PST)
Received-SPF: neutral (google.com: 194.109.24.33 is neither permitted nor denied by best guess record for domain of matijs@matijs.net) client-ip=194.109.24.33;
Received: from [10.0.0.20] (mvz.xs4all.nl [83.163.118.181])
	(authenticated bits=0)
	by smtp-vbr13.xs4all.nl (8.13.8/8.13.8) with ESMTP id q1RGEutB074386
	(version=TLSv1/SSLv3 cipher=AES256-SHA bits=256 verify=NO)
	for <ruby-ffi@googlegroups.com>; Mon, 27 Feb 2012 17:14:59 +0100 (CET)
	(envelope-from matijs@matijs.net)
Message-ID: <4F4BABFF.6010906@matijs.net>
Date: Mon, 27 Feb 2012 17:14:55 +0100
From: Matijs van Zuijlen <matijs@matijs.net>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:8.0) Gecko/20120216 Icedove/8.0
MIME-Version: 1.0
To: ruby-ffi@googlegroups.com
Subject: Re: [ruby-ffi] FFI check & questions
References: <4F4ADBD9.7050708@toppan-f.co.jp>
In-Reply-To: <4F4ADBD9.7050708@toppan-f.co.jp>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Original-Sender: matijs@matijs.net
X-Original-Authentication-Results: gmr-mx.google.com; spf=neutral (google.com:
 194.109.24.33 is neither permitted nor denied by best guess record for domain
 of matijs@matijs.net) smtp.mail=matijs@matijs.net
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
X-Google-Group-Id: 238405446264
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=en_US>, <mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=en_US>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=en_US>
Sender: ruby-ffi@googlegroups.com
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, <mailto:ruby-ffi+subscribe@googlegroups.com>
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>,
 <mailto:googlegroups-manage+238405446264+unsubscribe@googlegroups.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Hi Jeffrey,

On 02/27/2012 02:26 AM, Jeffrey Jones wrote:
> I am in the process of looking at using the following library from ruby
> (http://www.datalogics.com/products/pdf2img/) using FFI but have run into a few
> issues mainly due to my lack of FFI experience and general lack of C++.
>
> [...]
>
> The following Gist has the example C++ code (Posted with permission) and my Ruby
> code along side some example output. https://gist.github.com/1920005
>
> [...]
>
> On line 22 of the ruby file I have defined the second argument as an :int, this
> is probably wrong but it suffices for the moment I think. I assume the real
> value is an Enumeration, struct or something along those lines. It is not
> documented so I will ask the original developers.

You should take a look at the file 'pdf2imglib.h', to see what the values of 
that enumeration are. In particular, what integer value corresponds to GIFoutput.

> Questions:
>
> 1. On line 40 of the ruby file the required memory is apparently 4Gb, this is
> obviously wrong, does anyone know why? (I assume I have messed something up
> somewhere)

Perhaps setting the output type to 0 is wrong. I'm not sure what output type 
would demand 4GB, though.

> 2. Can anyone see any other obvious mistakes on my part?

I'm guessing allocating 4GB is not going very well. Do check the that the 
resulting pointer isn't null, i.e., with picBuf.null?

Regards,
-- 
Matijs
