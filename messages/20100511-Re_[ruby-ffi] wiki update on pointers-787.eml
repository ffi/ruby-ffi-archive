Delivered-To: headius@headius.com
Received: by 10.229.186.206 with SMTP id ct14cs21222qcb;
        Tue, 11 May 2010 10:01:14 -0700 (PDT)
Received: by 10.142.149.40 with SMTP id w40mr3813622wfd.334.1273597273454;
        Tue, 11 May 2010 10:01:13 -0700 (PDT)
Return-Path: <ruby-ffi+bncCMPYuayYERDWmqbfBBoE-avOGA@googlegroups.com>
Received: from mail-yx0-f153.google.com (mail-yx0-f153.google.com [209.85.210.153])
        by mx.google.com with ESMTP id 31si5282380ywh.105.2010.05.11.10.01.12;
        Tue, 11 May 2010 10:01:12 -0700 (PDT)
Received-SPF: pass (google.com: domain of ruby-ffi+bncCMPYuayYERDWmqbfBBoE-avOGA@googlegroups.com designates 209.85.210.153 as permitted sender) client-ip=209.85.210.153;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of ruby-ffi+bncCMPYuayYERDWmqbfBBoE-avOGA@googlegroups.com designates 209.85.210.153 as permitted sender) smtp.mail=ruby-ffi+bncCMPYuayYERDWmqbfBBoE-avOGA@googlegroups.com; dkim=pass (test mode) header.i=@googlegroups.com
Received: by yxe17 with SMTP id 17sf4527708yxe.22
        for <headius@headius.com>; Tue, 11 May 2010 10:01:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=beta;
        h=domainkey-signature:received:x-beenthere:received:received:received
         :received:received-spf:received:mime-version:received:received
         :in-reply-to:references:date:message-id:subject:from:to
         :x-original-authentication-results:x-original-sender:reply-to
         :precedence:mailing-list:list-id:list-post:list-help:list-archive
         :sender:list-subscribe:list-unsubscribe:content-type;
        bh=Le5xnEvaSU+Tn+6YRpYtCyVlm74t7pWNdEoOLhdQhTw=;
        b=qUMLo3U+lPJjS/zUq9b4x0BNguwalrB4+75hzZZTsScq9LlIV+Z/iTk1poHpkHJGIg
         bTVo6nKl3V7jchcTwE5w/FOqmJnwxu1QK+UJH1eBXFk4lTVRYA0f41C4ZHfUbzdaIyPX
         zYp2eSyKbS4W35QeF5wvUpTSTPwQPhTdzsNxE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlegroups.com; s=beta;
        h=x-beenthere:received-spf:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:x-original-authentication-results
         :x-original-sender:reply-to:precedence:mailing-list:list-id
         :list-post:list-help:list-archive:sender:list-subscribe
         :list-unsubscribe:content-type;
        b=EBBsDDonrNF+fJ0iSU0syFG7U79ssDf92d6phtlGrYfyv22yP5H2ftGXGkyIL94ZMn
         rnSUbPdfsiDdMvybk98kVQT1RBfd8Vgh7T0HXOo6qs6wtbAXWGAjXyMVUGYbEhSkqUc6
         C9sLCsNz0WhtM3PKphSpmOFBLXamtKxbGzTBc=
Received: by 10.91.162.19 with SMTP id p19mr483646ago.58.1273597270440;
        Tue, 11 May 2010 10:01:10 -0700 (PDT)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.231.187.210 with SMTP id cx18ls7921755ibb.0.p; Tue, 11 May 
	2010 10:01:09 -0700 (PDT)
Received: by 10.115.115.4 with SMTP id s4mr1407627wam.27.1273597269593;
        Tue, 11 May 2010 10:01:09 -0700 (PDT)
Received: by 10.115.115.4 with SMTP id s4mr1407625wam.27.1273597269555;
        Tue, 11 May 2010 10:01:09 -0700 (PDT)
Return-Path: <jvoorhis@gmail.com>
Received: from mail-vw0-f52.google.com (mail-vw0-f52.google.com [209.85.212.52])
        by gmr-mx.google.com with ESMTP id r3si6316303waj.7.2010.05.11.10.01.08;
        Tue, 11 May 2010 10:01:08 -0700 (PDT)
Received-SPF: pass (google.com: domain of jvoorhis@gmail.com designates 209.85.212.52 as permitted sender) client-ip=209.85.212.52;
Received: by mail-vw0-f52.google.com with SMTP id 14so1373528vws.11
        for <ruby-ffi@googlegroups.com>; Tue, 11 May 2010 10:01:07 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.224.73.73 with SMTP id p9mr4016798qaj.320.1273597266864; Tue, 
	11 May 2010 10:01:06 -0700 (PDT)
Received: by 10.229.229.144 with HTTP; Tue, 11 May 2010 10:01:06 -0700 (PDT)
In-Reply-To: <383FE988-D919-4629-AD7C-E115AB5315CB@mac.com>
References: <383FE988-D919-4629-AD7C-E115AB5315CB@mac.com>
Date: Tue, 11 May 2010 10:01:06 -0700
Message-ID: <AANLkTinI-dPu4r_wHfrv3K0Cg-fvJfnB9K7-UIt56jXD@mail.gmail.com>
Subject: Re: [ruby-ffi] wiki update on pointers
From: Jeremy Voorhis <jvoorhis@gmail.com>
To: ruby-ffi@googlegroups.com
X-Original-Authentication-Results: gmr-mx.google.com; spf=pass (google.com: 
	domain of jvoorhis@gmail.com designates 209.85.212.52 as permitted sender) 
	smtp.mail=jvoorhis@gmail.com; dkim=pass (test mode) header.i=@gmail.com
X-Original-Sender: jvoorhis@gmail.com
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=en_US>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=en_US>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=en_US>
Sender: ruby-ffi@googlegroups.com
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=en_US>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
Content-Type: multipart/alternative; boundary=00c09f7b2a4aadf581048654788b

--00c09f7b2a4aadf581048654788b
Content-Type: text/plain; charset=UTF-8

It looks correct to me, except in my experience, MemoryPointer makes it
unnecessary to wrap malloc(). For example, instead of,
  LibC.malloc(baz.first.size * baz.size)
I would write,
MemoryPointer.new(baz.first.size * baz.size).

The block form of MemoryPointer is also useful for automatically freeing the
pointer when finished.

MemoryPointer.new(baz.first.size * baz.size) do |p|
p.write_array_of_int(baz)
C.DoSomethingWithArrayOfInt(p)
end

Best,

Jeremy

On Tue, May 11, 2010 at 9:02 AM, Chuck Remes <cremes.devlist@mac.com> wrote:

> I just wrote an update to the wiki page on pointers at
> http://wiki.github.com/ffi/ffi/pointers
>
> I'd appreciate it if someone more knowledgeable would check it over (the
> bottom section under the sub-heading) and verify that what I wrote is
> correct. It seems to be working for me but I've been wrong before! :)
>
> cr
>
>

--00c09f7b2a4aadf581048654788b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<font class=3D"Apple-style-span" face=3D"arial, helvetica, sans-serif"><fon=
t class=3D"Apple-style-span" color=3D"#330033">It looks correct to me, exce=
pt in my experience, MemoryPointer makes it unnecessary to wrap malloc(). F=
or example, instead of,</font></font><div>
<font class=3D"Apple-style-span" face=3D"arial, helvetica, sans-serif"><fon=
t class=3D"Apple-style-span" color=3D"#330033">=C2=A0=C2=A0</font></font><s=
pan class=3D"Apple-style-span" style=3D"font-size: 12px; line-height: 16px;=
 white-space: pre; "><font class=3D"Apple-style-span" face=3D"arial, helvet=
ica, sans-serif"><font class=3D"Apple-style-span" color=3D"#330033">LibC.ma=
lloc(baz.first.size * baz.size)</font></font></span></div>
<div><span class=3D"Apple-style-span" style=3D"font-family: arial, helvetic=
a, sans-serif; font-size: 12px; line-height: 16px; white-space: pre; "><fon=
t class=3D"Apple-style-span" color=3D"#330033">I would write,</font></span>=
</div>
<div><span class=3D"Apple-style-span" style=3D"font-family: arial, helvetic=
a, sans-serif; font-size: 12px; line-height: 16px; white-space: pre; "><fon=
t class=3D"Apple-style-span" color=3D"#330033">  MemoryPointer.new(baz.firs=
t.size * baz.size).</font></span></div>
<div><span class=3D"Apple-style-span" style=3D"font-family: arial, helvetic=
a, sans-serif; font-size: 12px; line-height: 16px; white-space: pre; "><fon=
t class=3D"Apple-style-span" color=3D"#330033"><br></font></span></div><div=
><span class=3D"Apple-style-span" style=3D"font-family: arial, helvetica, s=
ans-serif; font-size: 12px; line-height: 16px; white-space: pre; "><font cl=
ass=3D"Apple-style-span" color=3D"#330033">The block form of MemoryPointer =
is also useful for automatically freeing the pointer when finished.</font><=
/span></div>
<div><span class=3D"Apple-style-span" style=3D"font-family: arial, helvetic=
a, sans-serif; font-size: 12px; line-height: 16px; white-space: pre; "><fon=
t class=3D"Apple-style-span" color=3D"#330033"><br></font></span></div><div=
><font class=3D"Apple-style-span" color=3D"#330033" face=3D"arial, helvetic=
a, sans-serif" size=3D"3"><span class=3D"Apple-style-span" style=3D"font-si=
ze: 12px; line-height: 16px; white-space: pre;">MemoryPointer.new(baz.first=
.size * baz.size) do |p|</span></font></div>
<div><font class=3D"Apple-style-span" color=3D"#330033" face=3D"arial, helv=
etica, sans-serif" size=3D"3"><span class=3D"Apple-style-span" style=3D"fon=
t-size: 12px; line-height: 16px; white-space: pre;">  p.write_array_of_int(=
baz)</span></font></div>
<div><font class=3D"Apple-style-span" color=3D"#330033" face=3D"arial, helv=
etica, sans-serif" size=3D"3"><span class=3D"Apple-style-span" style=3D"fon=
t-size: 12px; line-height: 16px; white-space: pre;">  C.DoSomethingWithArra=
yOfInt(p)</span></font></div>
<div><font class=3D"Apple-style-span" color=3D"#330033" face=3D"arial, helv=
etica, sans-serif" size=3D"3"><span class=3D"Apple-style-span" style=3D"fon=
t-size: 12px; line-height: 16px; white-space: pre;">end</span></font></div>=
<div><br>
</div><div>Best,</div><div><br></div><div>Jeremy</div><div><br><div class=
=3D"gmail_quote">On Tue, May 11, 2010 at 9:02 AM, Chuck Remes <span dir=3D"=
ltr">&lt;<a href=3D"mailto:cremes.devlist@mac.com">cremes.devlist@mac.com</=
a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex;">I just wrote an update to the wiki page on =
pointers at <a href=3D"http://wiki.github.com/ffi/ffi/pointers" target=3D"_=
blank">http://wiki.github.com/ffi/ffi/pointers</a><br>

<br>
I&#39;d appreciate it if someone more knowledgeable would check it over (th=
e bottom section under the sub-heading) and verify that what I wrote is cor=
rect. It seems to be working for me but I&#39;ve been wrong before! :)<br>

<font color=3D"#888888"><br>
cr<br>
<br>
</font></blockquote></div><br></div>

--00c09f7b2a4aadf581048654788b--
