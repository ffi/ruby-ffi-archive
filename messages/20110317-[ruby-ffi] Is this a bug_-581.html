<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>[ruby-ffi] Is this a bug?</title>
<link rel="important stylesheet" href="">
<style>div.headerdisplayname {font-weight:bold;}</style></head>
<body>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><div class="headerdisplayname" style="display:inline;">Subject: </div>[ruby-ffi] Is this a bug?</td></tr><tr><td><div class="headerdisplayname" style="display:inline;">From: </div>David <lilgeekboy@gmail.com></td></tr><tr><td><div class="headerdisplayname" style="display:inline;">Date: </div>3/17/11 9:57 PM</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><div class="headerdisplayname" style="display:inline;">To: </div>ruby-ffi <ruby-ffi@googlegroups.com></td></tr></table><br>
<div class="moz-text-plain" wrap=true graphical-quote=true style="font-family: -moz-fixed; font-size: 12px;" lang="x-western"><pre wrap>
I was going through the group messages and found what I was looking
for but it doesn't seem to work anymore.

ppdev = FFI::MemoryPointer.new :pointer
errbuf = FFI::MemoryPointer.new :char, Pcap::PCAP_ERRBUF_SIZE
res = Pcap.pcap_findalldevs(ppdev, errbuf)

<a class="moz-txt-link-freetext" href="http://groups.google.com/group/ruby-ffi/browse_thread/thread/26de1897ec0597a5">http://groups.google.com/group/ruby-ffi/browse_thread/thread/26de1897ec0597a5</a>

This code raises invalid string parameter and when passing in an empty
string instead of errbuf the JVM crashes because various registers are
holding invalid pointer addresses.

The problem exists in both Jruby 1.6(using ruby 1.9.2) and MRI 1.9.2.
</pre></div></body>
</html>
</table></div>