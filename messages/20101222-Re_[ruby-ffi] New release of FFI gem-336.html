<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Re: [ruby-ffi] New release of FFI gem</title>
<link rel="important stylesheet" href="">
<style>div.headerdisplayname {font-weight:bold;}</style></head>
<body>
<table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part1"><tr><td><div class="headerdisplayname" style="display:inline;">Subject: </div>Re: [ruby-ffi] New release of FFI gem</td></tr><tr><td><div class="headerdisplayname" style="display:inline;">From: </div>Evan Phoenix <evan@fallingsnow.net></td></tr><tr><td><div class="headerdisplayname" style="display:inline;">Date: </div>12/22/10 1:24 PM</td></tr></table><table border=0 cellspacing=0 cellpadding=0 width="100%" class="header-part2"><tr><td><div class="headerdisplayname" style="display:inline;">To: </div>ruby-ffi@googlegroups.com</td></tr></table><br>
<div class="moz-text-plain" wrap=true graphical-quote=true style="font-family: -moz-fixed; font-size: 12px;" lang="x-western"><pre wrap>

On Dec 22, 2010, at 11:16 AM, Charles Oliver Nutter wrote:

</pre><blockquote type=cite style="color: #000000;"><pre wrap>
<span class="moz-txt-citetags">&gt; </span>On Fri, Dec 3, 2010 at 4:57 AM, Wayne Meissner <a class="moz-txt-link-rfc2396E" href="mailto:wmeissner@gmail.com">&lt;wmeissner@gmail.com&gt;</a> wrote:
</pre><blockquote type=cite style="color: #000000;"><blockquote type=cite style="color: #000000;"><pre wrap>
<span class="moz-txt-citetags">&gt;&gt;&gt; </span>If FFI is aiming 1.9.2 or bigger, then the rubygem spec needs to be
<span class="moz-txt-citetags">&gt;&gt;&gt; </span>tweaked to reflect that. I'm not against of ditching 1.8.x support,
<span class="moz-txt-citetags">&gt;&gt;&gt; </span>but just want to reduce painful support issues for users still using
<span class="moz-txt-citetags">&gt;&gt;&gt; </span>1.8.x
</pre></blockquote><pre wrap>
<span class="moz-txt-citetags">&gt;&gt; </span>
<span class="moz-txt-citetags">&gt;&gt; </span>Agreed, and I just pushed a change the restricts it to &gt;= 1.9.2
<span class="moz-txt-citetags">&gt;&gt; </span>
<span class="moz-txt-citetags">&gt;&gt; </span>I'm not against it still working on 1.8.7 - I'm just against:
<span class="moz-txt-citetags">&gt;&gt; </span>
<span class="moz-txt-citetags">&gt;&gt; </span>a) doing the work to make it work, and
<span class="moz-txt-citetags">&gt;&gt; </span>b) dealing with issues when people try to run code that either
<span class="moz-txt-citetags">&gt;&gt; </span>requires blocking threads, or non-ruby threads calling back into ruby.
</pre></blockquote><pre wrap>
<span class="moz-txt-citetags">&gt; </span>
<span class="moz-txt-citetags">&gt; </span>I think it's premature to drop 1.8.7 support. The majority of Ruby
<span class="moz-txt-citetags">&gt; </span>users are still on 1.8.7, and that's not changing rapidly. There's
<span class="moz-txt-citetags">&gt; </span>also people with production apps and released libraries that depend on
<span class="moz-txt-citetags">&gt; </span>FFI.
<span class="moz-txt-citetags">&gt; </span>
<span class="moz-txt-citetags">&gt; </span>I think we need to find a way to get support back in there ASAP.
<span class="moz-txt-citetags">&gt; </span>Perhaps that means we need to actively find someone to help Wayne
<span class="moz-txt-citetags">&gt; </span>maintain the FFI gem (or take over 1.8 support completely). If we
<span class="moz-txt-citetags">&gt; </span>don't have FFI for 1.8.7, it becomes substantially less useful as a
<span class="moz-txt-citetags">&gt; </span>cross-impl replacement for extensions.
</pre></blockquote><pre wrap>

I agree. Sorry that I didn't chime in when 1.0.0 was released also, I got tied up with the Rubinius 1.2 release.

</pre><blockquote type=cite style="color: #000000;"><pre wrap>
<span class="moz-txt-citetags">&gt; </span>
<span class="moz-txt-citetags">&gt; </span>I appreciate the issues with blocking threads, but I think that's a
<span class="moz-txt-citetags">&gt; </span>peril for any C extension on 1.8.7. In other words...we punt, since
<span class="moz-txt-citetags">&gt; </span>there's no solution, and recommend people consider blocking calls when
<span class="moz-txt-citetags">&gt; </span>using libraries through FFI.
</pre></blockquote><pre wrap>

I agree this, is a tricky problem that Wayne has done a great job supporting. But I think that the difficulty in it points that it's just not possible to do properly with the architecture of 1.8. Not supporting callbacks on non-ruby threads seems like an OK compromise. Are there a lot of people using this functionality?

</pre><blockquote type=cite style="color: #000000;"><pre wrap>
<span class="moz-txt-citetags">&gt; </span>
<span class="moz-txt-citetags">&gt; </span>Wayne: Can you summarize what's needed to get 1.8.7 support back in the gem?
</pre></blockquote><pre wrap>

Wayne, in the past we've talked about me help with the gem development and API. I'm happy to start doing this in earnest.

</pre><blockquote type=cite style="color: #000000;"><pre wrap>
<span class="moz-txt-citetags">&gt; </span>
<span class="moz-txt-citetags">&gt; </span>- Charlie
<span class="moz-txt-citetags">&gt; </span>
</pre></blockquote><pre wrap>

</pre></div></body>
</html>
</table></div>