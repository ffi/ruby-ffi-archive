Delivered-To: headius@headius.com
Received: by 10.100.134.8 with SMTP id h8cs440264and;
        Sat, 19 Dec 2009 16:04:18 -0800 (PST)
Received: by 10.114.45.10 with SMTP id s10mr3731797was.76.1261267457980;
        Sat, 19 Dec 2009 16:04:17 -0800 (PST)
Return-Path: <3_2ktSwkJCOEZPHLVVQHUJPDLO.FRPUXEb-IILJRRJOHJURXSV.FRP@listserv.bounces.google.com>
Received: from mail-pz0-f148.google.com (mail-pz0-f148.google.com [209.85.222.148])
        by mx.google.com with ESMTP id 10si9412031pzk.50.2009.12.19.16.04.16;
        Sat, 19 Dec 2009 16:04:16 -0800 (PST)
Received-SPF: pass (google.com: domain of 3_2ktSwkJCOEZPHLVVQHUJPDLO.FRPUXEb-IILJRRJOHJURXSV.FRP@listserv.bounces.google.com designates 209.85.222.148 as permitted sender) client-ip=209.85.222.148;
Authentication-Results: mx.google.com; spf=pass (google.com: domain of 3_2ktSwkJCOEZPHLVVQHUJPDLO.FRPUXEb-IILJRRJOHJURXSV.FRP@listserv.bounces.google.com designates 209.85.222.148 as permitted sender) smtp.mail=3_2ktSwkJCOEZPHLVVQHUJPDLO.FRPUXEb-IILJRRJOHJURXSV.FRP@listserv.bounces.google.com; dkim=pass (test mode) header.i=@googlegroups.com
Received: by pzk12 with SMTP id 12sf1659053pzk.13
        for <headius@headius.com>; Sat, 19 Dec 2009 16:04:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlegroups.com; s=beta;
        h=domainkey-signature:received:x-beenthere:received:received:received
         :received:received-spf:received:mime-version:received:in-reply-to
         :references:date:message-id:subject:from:to
         :x-original-authentication-results:x-original-sender:reply-to
         :precedence:mailing-list:list-id:list-post:list-help:list-archive
         :x-thread-url:x-message-url:sender:list-unsubscribe:list-subscribe
         :content-type;
        bh=MGykET3dwJB8h0BrKucuH5Fnv2BNE7DdjGjtc1IZjA0=;
        b=beKL9Ng1h0GESGOjrHO4UcPUPaTxBvnWeAQaZLBJc2XMM8Fvd97dtJ5FaTgPOwZqDo
         SVzAeVkURT6nQ6DH4b38dNLmY/+KGAbjib28nm0fr1AR5xsUkUEEENvTFpr5t3Er7EnJ
         9PEb18ZUOMWgeKz63DQ7kNcLn5ykLh3y1KOZM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlegroups.com; s=beta;
        h=x-beenthere:received-spf:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:x-original-authentication-results
         :x-original-sender:reply-to:precedence:mailing-list:list-id
         :list-post:list-help:list-archive:x-thread-url:x-message-url:sender
         :list-unsubscribe:list-subscribe:content-type;
        b=Vv1z2oK+pebX/NEvZeYRsILtmbTCF1OFCrjBxhoBKHX0Vy78E34mkWlbh6Ijx48zgi
         UrRQdUALUVMiW3q7sgciTo934JxaKz29G1elKLaKqbEoOgi3a73o21QeNz7NUlZgKKlO
         KR3qAoKQTh1I2KwNKo94we07AvrDDM9/emGfM=
Received: by 10.115.39.9 with SMTP id r9mr678276waj.4.1261267455678;
        Sat, 19 Dec 2009 16:04:15 -0800 (PST)
X-BeenThere: ruby-ffi@googlegroups.com
Received: by 10.115.116.23 with SMTP id t23ls200924wam.1.p; Sat, 19 Dec 2009 
	16:04:15 -0800 (PST)
Received: by 10.115.84.28 with SMTP id m28mr1224798wal.29.1261267454965;
        Sat, 19 Dec 2009 16:04:14 -0800 (PST)
Received: by 10.115.84.28 with SMTP id m28mr1224797wal.29.1261267454947;
        Sat, 19 Dec 2009 16:04:14 -0800 (PST)
Return-Path: <wmeissner@gmail.com>
Received: from mail-pw0-f46.google.com (mail-pw0-f46.google.com [209.85.160.46])
        by gmr-mx.google.com with ESMTP id 1si1135463pxi.1.2009.12.19.16.04.13;
        Sat, 19 Dec 2009 16:04:13 -0800 (PST)
Received-SPF: pass (google.com: domain of wmeissner@gmail.com designates 209.85.160.46 as permitted sender) client-ip=209.85.160.46;
Received: by pwj16 with SMTP id 16so2993322pwj.5
        for <ruby-ffi@googlegroups.com>; Sat, 19 Dec 2009 16:04:13 -0800 (PST)
MIME-Version: 1.0
Received: by 10.141.89.16 with SMTP id r16mr3853211rvl.290.1261267450847; Sat, 
	19 Dec 2009 16:04:10 -0800 (PST)
In-Reply-To: <0B2F0969-5686-4B32-8543-6FF807C0E3DA@fallingsnow.net>
References: <540fa71e-d71e-4f04-b1ef-35559f147f9a@m3g2000yqf.googlegroups.com>
	 <0B2F0969-5686-4B32-8543-6FF807C0E3DA@fallingsnow.net>
Date: Sun, 20 Dec 2009 10:04:10 +1000
Message-ID: <4ccee320912191604x7cb4326bs833f19185510b5e9@mail.gmail.com>
Subject: Re: [ruby-ffi] struct questions
From: Wayne Meissner <wmeissner@gmail.com>
To: ruby-ffi@googlegroups.com
X-Original-Authentication-Results: gmr-mx.google.com; spf=pass (google.com: 
	domain of wmeissner@gmail.com designates 209.85.160.46 as permitted sender) 
	smtp.mail=wmeissner@gmail.com; dkim=pass (test mode) header.i=@gmail.com
X-Original-Sender: wmeissner@gmail.com
Reply-To: ruby-ffi@googlegroups.com
Precedence: list
Mailing-list: list ruby-ffi@googlegroups.com; contact ruby-ffi+owners@googlegroups.com
List-ID: <ruby-ffi.googlegroups.com>
List-Post: <http://groups.google.com/group/ruby-ffi/post?hl=>, 
	<mailto:ruby-ffi@googlegroups.com>
List-Help: <http://groups.google.com/support/?hl=>, <mailto:ruby-ffi+help@googlegroups.com>
List-Archive: <http://groups.google.com/group/ruby-ffi?hl=>
X-Thread-Url: http://groups.google.com/group/ruby-ffi/t/109da9d55f08ceaf
X-Message-Url: http://groups.google.com/group/ruby-ffi/msg/b4b7f71222e9f15e
Sender: ruby-ffi@googlegroups.com
List-Unsubscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+unsubscribe@googlegroups.com>
List-Subscribe: <http://groups.google.com/group/ruby-ffi/subscribe?hl=>, 
	<mailto:ruby-ffi+subscribe@googlegroups.com>
Content-Type: text/plain; charset=ISO-8859-1

2009/12/19 Evan Phoenix <evan@fallingsnow.net>:
>
> On Dec 18, 2009, at 5:00 PM, rogerdpack wrote:

>> is there an easier way than ss[:title][0] = 33; ss[:title][1] = 34; //
>> one at a time?
>
> If this works, it should not. The return value should not be references the memory of the array itself in the struct, thats not safe.

Can you elaborate on the "not safe"?

To make sure we're all on the same page, Roger was talking about
something like this:

struct S {
  char title[20];
}

Which in ruby-ffi is:

class S < FFI::Struct
  layout :title, [ :char, 20 ]
end

>
> Because char_array is an explicit type, #put could support it since the size of the char_array should be known by #put.

:char_array isn't supported in ruby-ffi currently.  Although it could
possibly be made to work, it would be complicated in the absence of
offsets on the fields in auto-layout mode, and really does not offer
anything over the ruby-ffi array field syntax.
